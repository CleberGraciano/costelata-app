<div class="card p-p-3">
  <form [formGroup]="filtroForm" (ngSubmit)="pesquisar()">
    <div class="p-fluid p-formgrid p-grid">
      <div class="p-field p-col-12 p-md-2">
        <label for="codigo">Código</label>
        <input id="codigo" type="text" pInputText formControlName="codigo" />
      </div>
      <div class="p-field p-col-12 p-md-4">
        <label for="descricao">Descrição</label>
        <input id="descricao" type="text" pInputText formControlName="descricao" />
      </div>
      <div class="p-field p-col-12 p-md-3">
        <label for="categoria">Categoria</label>
        <p-dropdown formControlName="categoria" [options]="categorias" optionLabel="descricao" [showClear]="true"
          placeholder="Selecione uma categoria">
        </p-dropdown>
      </div>
      <div class="p-field p-col-12 p-md-3">
        <label for="status">Status</label>
        <p-dropdown formControlName="status" [options]="status" optionLabel="descricao" [showClear]="true"
          placeholder="Selecione um status">
        </p-dropdown>
      </div>

      <!-- <div class="p-field p-col-12 p-md-3">
        <label for="quantidadeMinima">Qtd. Mínima</label>
        <input id="quantidadeMinima" type="number" pInputText formControlName="quantidadeMinima" [min]="0"
          [max]="999999999" />
      </div>

      <div class="p-field p-col-12 p-md-3">
        <label for="quantidadeMaxima">Qtd. Máxima</label>
        <input id="quantidadeMaxima" type="number" pInputText formControlName="quantidadeMaxima" [min]="0"
          [max]="999999999" />
      </div>

      <div class="p-field p-col-12 p-md-3">
        <label for="valorMinimo">Valor Mínimo</label>
        <input id="valorMinimo" type="text" pInputText formControlName="valorMinimo" mask="separator.2" prefix="R$ " />
      </div>

      <div class="p-field p-col-12 p-md-3">
        <label for="valorMaximo">Valor Máximo</label>
        <input id="valorMaximo" type="text" pInputText formControlName="valorMaximo" mask="separator.2" prefix="R$ " />
      </div> -->
    </div>

    <div class="flex justify-end gap-3 mt-4">
      <button type="button" (click)="limparFiltro()"
        class="flex items-center gap-2 border border-primary-500 text-primary-500 px-4 py-2 rounded hover:bg-primary-500 hover:text-white transition">
        <i class="pi pi-times"></i>
        Limpar
      </button>

      <button type="submit"
        class="flex items-center gap-2 bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700 transition">
        <i class="pi pi-search"></i>
        Buscar
      </button>
    </div>
  </form>

  <div class="mt-12" #table>
    <p-table [value]="produtos" [paginator]="true" [rows]="rows" [totalRecords]="totalRecords" [lazy]="true"
      (onLazyLoad)="onLazyLoad($event)" [rowsPerPageOptions]="[5,10,20]" [responsiveLayout]="'scroll'"
      [resizableColumns]="true" [sortMode]="'multiple'" [loading]="carregando" [showCurrentPageReport]="true"
      currentPageReportTemplate="Exibindo {first} a {last} de {totalRecords} produtos">
      <ng-template pTemplate="header">
        <tr>
          <th class="!text-left">
            <div class="flex items-center gap-1" pSortableColumn="codigo_produto">
              Código <p-sortIcon field="codigo_produto" styleClass="text-sm"></p-sortIcon>
            </div>
          </th>
          <th class="!text-left">
            <div class="flex items-center gap-1" pSortableColumn="descricao">
              Descrição <p-sortIcon field="descricao" styleClass="text-sm"></p-sortIcon>
            </div>
          </th>
          <th class="!text-left">
            <div class="flex items-center gap-1" pSortableColumn="unidade">
              Unidade <p-sortIcon field="unidade" styleClass="text-sm"></p-sortIcon>
            </div>
          </th>
          <th class="!text-left">
            <div class="flex items-center gap-1" pSortableColumn="valor_unitario">
              Valor <p-sortIcon field="valor_unitario" styleClass="text-sm"></p-sortIcon>
            </div>
          </th>
          <th class="!text-left">
            <div class="flex items-center gap-1" pSortableColumn="descricao_familia">
              Familia <p-sortIcon field="descricao_familia" styleClass="text-sm"></p-sortIcon>
            </div>
          </th>
          <th class="!text-left">
            <div class="flex items-center gap-1" pSortableColumn="categoria">
              Categoria <p-sortIcon field="categoria" styleClass="text-sm"></p-sortIcon>
            </div>
          </th>
          <th class="!text-left">Ações</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-produto>
        <tr>
          <td>{{ produto.codigo_produto }}</td>
          <td>{{ produto.descricao }}</td>
          <td>{{ produto.unidade }}</td>
          <td>{{ produto.valor_unitario | currency:'BRL' }}</td>
          <td>{{ produto.descricao_familia }}</td>
          <td>{{ produto.categoria }}</td>
          <td class="flex justify-start gap-2">
            <button pButton icon="pi pi-pencil" type="button"
              class="p-button p-button-rounded border-none text-primary-400 hover:text-primary-600" pTooltip="Editar Produto" tooltipPosition="top"
              (click)="editar(produto)">
            </button>
            <!-- <button pButton icon="pi pi-trash" type="button"
              class="p-button p-button-rounded border-none text-primary-600 hover:text-primary-500" pTooltip="Excluir Produto"  tooltipPosition="top"
              (click)="excluir(produto)">
            </button> -->
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center">Nenhum produto encontrado.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<p-toast></p-toast>
